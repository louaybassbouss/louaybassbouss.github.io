<!-- sender.html -->
<!doctype html>
<html>
<head>
   <title>Sender Example</title>
   <link href="style.css" rel="stylesheet" type="text/css" />
   <script type="text/javascript" src="http://famium.fokus.fraunhofer.de/webscreens/js/webscreens.all.min.js"></script>
   <script type="text/javascript" src="js/Sync.js"></script>
   <script type="text/javascript">
      navigator.presentation.onavailablechange = function(dict){
         if(dict.available){
            var session = navigator.presentation.requestSession("receiver.html");
            var master = new sync.Master(session);
            session.onstatechange = function(){
               if(session.state == "connected"){
                  master.init("show area");
				  session.postMessage("foo");
               }
               else if(session.state == "disconnected"){
                  master.destroy();
               }
            }
         }
      };
   </script>
   
</head>
<body>
<body>
	<div id="container">
	<div id="title">
		<p  class="title_p">The Platform</p>
		<p  class="title_e">------Peer</p>
	</div>

	<div class="d1" id="show area">
		<table width="95%">
			<tr>
				<td  id="201" width="200px" height="130"></td>
				<td  id="202" width="200px" height="130"></td>
				<td  id="203" width="200px" height="130"></td>
				<td  id="204" width="200px" height="130"></td>
			</tr>
			<tr>
				<td  id="205" width="200px" height="130"></td>
				<td  id="206" width="200px" height="130"></td>
				<td  id="207" width="200px" height="130"></td>
				<td  id="208" width="200px" height="130"></td>
			</tr>
			<tr>
				<td  id="209" width="200px" height="130"></td>
				<td  id="210" width="200px" height="130"></td>
				<td  id="211" width="200px" height="130"></td>
				<td  id="212" width="200px" height="130"></td>
			</tr>
			<tr>
				<td  id="213" width="200px" height="130"></td>
				<td  id="214" width="200px" height="130"></td>
				<td  id="215" width="200px" height="130"></td>
				<td  id="216" width="200px" height="130"></td>
			</tr>
			<tr>
				<td  id="217" width="200px" height="130"></td>
				<td  id="218" width="200px" height="130"></td>
				<td  id="219" width="200px" height="130"></td>
				<td  id="220" width="200px" height="130"></td>
			</tr>
		</table>
	</div>
	<div id="operate area">
		<table width="95%">
		<tr>
			<td id="101" width="200px" height="130">
				<div id="img1">
					<img src="/img/Sample01.jpg" onload='loadImage(this)' onclick="add_mark(this)"/>
				</div>
			</td>
			<td id="102" width="200px" height="130">
				<div id="img2">
					<img src="/img/Sample02.jpg" onload='loadImage(this)' onclick="add_mark(this)"/>
				</div>
			</td>
			<td  id="103" width="200px" height="130">
				<div id="img3">
					<img src="/img/Sample03.jpg" onload='loadImage(this)'  onclick="add_mark(this)"/>
				</div>
			</td>
			<td id="104" width="200px" height="130">
				<div id="img4">
					<img src="/img/Sample04.jpg" onload='loadImage(this)'  onclick="add_mark(this)"/>
				</div>
			</td>
		</tr>
		<tr>
			<td id="105" width="200px" height="130">
				<div id="img5">
					<img src="/img/Sample05.jpg" onload='loadImage(this)' onclick="add_mark(this)"/>
				</div>
			</td>
			<td id="106" width="200px" height="130">
				<div id="img6">
					<img src="/img/Sample06.jpg" onload='loadImage(this)'  onclick="add_mark(this)"/>
				</div>
			</td>
			<td id="107" width="200px" height="130">
				<div id="img7">
					<img src="/img/Sample07.jpg" onload='loadImage(this)' onclick="add_mark(this)"/>
				</div>
			</td>
			<td id="108" width="200px" height="130">
				<div id="img8">
					<img src="/img/Sample08.jpg" onload='loadImage(this)' onclick="add_mark(this)"/>
				</div>
			</td>
		</tr>
		<tr>
			<td id="109" width="200px" height="130">
				<div id="img9">
					<img src="/img/Sample09.jpg" onload='loadImage(this)' onclick="add_mark(this)"/>
				</div>
			</td>
			<td id="110" width="200px" height="130">
				<div id="img10">
					<img src="/img/Sample10.jpg" onload='loadImage(this)' onclick="add_mark(this)" />
				</div>
			</td>
			<td id="111" width="200px" height="130">
				<div id="img11">
					<img src="/img/Sample11.jpg" onload='loadImage(this)' onclick="add_mark(this)" />
				</div>
			</td>
			<td id="112" width="200px" height="130">
				<div id="img12">
					<img src="/img/Sample12.jpg" onload='loadImage(this)'  onclick="add_mark(this)"/>
				</div>
			</td>
		</tr>
		<tr>
			<td id="113" width="200px" height="130">
				<div id="img13">
					<img src="/img/Sample13.jpg" onload='loadImage(this)'  onclick="add_mark(this)"/>
				</div>
			</td>
			<td id="114" width="200px" height="130">
				<div id="img14">
					<img src="/img/Sample14.jpg" onload='loadImage(this)' onclick="add_mark(this)" />
				</div>
			</td>
			<td id="115" width="200px" height="130">
				<div id="img15">
					<img src="/img/Sample15.jpg" onload='loadImage(this)' onclick="add_mark(this)" />
				</div>
			</td>
			<td id="116" width="200px" height="130">
				<div id="img16">
					<img src="/img/Sample16.jpg" onload='loadImage(this)' onclick="add_mark(this)"/>
				</div>
			</td>
		</tr>
		<tr>
			<td id="117" width="200px" height="130">
				<div id="img17">
					<img src="/img/Sample17.jpg" onload='loadImage(this)' onclick="add_mark(this)"/>
				</div>
			</td>
			<td id="118" width="200px" height="130">
				<div id="img18">
					<img src="/img/Sample18.jpg" onload='loadImage(this)' onclick="add_mark(this)" />
				</div>
			</td>
			<td id="119" width="200px" height="130">
				<div id="img19">
					<img src="/img/Sample19.jpg" onload='loadImage(this)' onclick="add_mark(this)"/>
				</div>
			</td>
			<td id="120" width="200px" height="130">
				<div id="img20">
					<img src="/img/Sample20.jpg" onload='loadImage(this)' onclick="add_mark(this)" />
				</div>
			</td>
		</tr>
		</table>
		<div id="submit_button">
			<input type="button" name="Submit" value="Submit" onclick="submit_it()">
		</div>		
	</div>
</body>
</body>
</html>
<script>

function add_mark(msg){
	class_id=document.getElementById(msg.parentNode.id);
	class_id.setAttribute("class", "d3");
	console.log(document.getElementById(msg.parentNode.id));
}

function submit_it(){
	var div=document.getElementById("operate area").getElementsByTagName("div");
	for(i=0; i < div.length; i++){
		if(div[i].className=="d3"){
			console.log(div[i].innerHTML);
			console.log(div[i].childNodes);
			var mark_div=document.createElement("DIV");
			mark_div.setAttribute("id",div[i].id);
			var rm_div=document.getElementById(div[i].id);
			rm_parent=rm_div.parentNode.id;
			x_id=Number(rm_parent)+100
			document.getElementById(x_id).appendChild(mark_div);
			var showImg = document.createElement("img"); 
			if(div[i].childNodes.length>2)
			{
				showImg.src=div[i].childNodes[1].src; 
			}else{
				showImg.src=div[i].childNodes[0].src;
			}	
			showImg.setAttribute("ondblclick","delete_item(this)");
			showImg.setAttribute("onload","loadImage(this)");
			console.log(div[i].id);
			document.getElementById(div[i].id).appendChild(showImg);
			document.getElementById(rm_parent).removeChild(rm_div);			
			i--;
			//console.log(div[i].childNodes[1].src);			
		}
	}

}
function loadImage(obj) {
    var   img =   new   Image();
    img.src=obj.src;     
    obj.width=img.width*100/img.height; 
    obj.height=100;
}

function delete_item(msg){
	console.log(msg.parentNode.parentNode.id);
	y_id=msg.parentNode.id;
	console.log(y_id);
	rm_parent=msg.parentNode.parentNode.id;
	console.log(rm_parent);
	var mark_div=document.createElement("DIV");
	var rm_div=document.getElementById(y_id);
	mark_div.setAttribute("id",y_id);
	x_id=Number(rm_parent)-100
	document.getElementById(x_id).appendChild(mark_div);
	var showImg = document.createElement("img");   
	showImg.src=msg.src; 
	showImg.setAttribute("onclick","add_mark(this)");
	showImg.setAttribute("onload","loadImage(this)");
	//console.log(div[i].id);
	document.getElementById(rm_parent).removeChild(rm_div);
	document.getElementById(y_id).appendChild(showImg);
				
}


</script>
